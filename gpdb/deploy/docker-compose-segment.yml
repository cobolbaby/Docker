version: "3"
services:

  sdw1:
    image: ${REGISTRY}/${TAGNAME}
    hostname: sdw1
    volumes:
      - /opt/greenplum/config:/opt/greenplum/config
      - /disk2/greenplum/primary:/data/greenplum/primary
      - /disk2/greenplum/mirror:/data/greenplum/mirror
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
      placement:
        constraints: [node.role != manager]

  sdw2:
    image: ${REGISTRY}/${TAGNAME}
    hostname: sdw2
    volumes:
      - /opt/greenplum/config:/opt/greenplum/config
      - /disk3/greenplum/primary:/data/greenplum/primary
      - /disk3/greenplum/mirror:/data/greenplum/mirror
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
      placement:
        constraints: [node.role != manager]

networks:
  default:
    external:
      name: gpdb